# SSH Exploiting

**SSH (Secure Shell)** è un protocollo di rete crittografato che permette di stabilire una connessione sicura tra due host. <br>
È comunemente usato per l’amministrazione remota di sistemi UNIX/Linux, e opera sulla porta TCP **22** per default. 

SSH permette due modalità di autenticazione:
1. **Username e password**: classico login testuale.
2. **Chiave pubblica/privata**: autenticazione tramite chiavi RSA/ECDSA, più sicura e automatizzata.

Nel contesto del penetration testing, la modalità con **username e password** è quella che si tenta di sfruttare tramite **brute force**, dato che è più comune in ambienti non configurati correttamente.

---

## 1 – Scansione e Riconoscimento

Il primo passo è determinare se il servizio SSH è attivo e quale versione sta girando sul target:

```bash
nmap -sV -p 22 <IP>         # rileva il servizio SSH e ne identifica la versione
```

La versione è importante per individuare eventuali vulnerabilità note, che possono essere ricercate usando:

```bash
searchsploit openssh <versione>   # mostra exploit noti per quella versione
```

---

## 2 – Brute Force con Hydra

Per tentare un attacco a forza bruta, si utilizza **Hydra**, fornendo liste di username e password:

```bash
hydra -L <usernameList> -P <passwordList> -t 4 <IP> ssh   # brute force SSH
```

* `-L` specifica il file contenente la lista degli username
* `-P` specifica il file delle password
* `-t 4` indica il numero di thread paralleli (per velocizzare)

> **Nota:** Per evitare lockout e non farsi bannare, valuta di usare una velocità ridotta e limiti nei tentativi.

---

## 3 – Connessione SSH con Credenziali Valide

Una volta trovata una coppia valida, ci si può connettere al sistema target:

```bash
ssh <username>@<IP>       # connessione SSH al target
```

Durante la prima connessione, comparirà il messaggio di conferma dell’identità del server:

```bash
Are you sure you want to continue connecting (yes/no)?
```

Scrivi `yes`, poi inserisci la **password** quando richiesta.

Una volta autenticati, si ha una shell remota completa sul sistema target.

---

## 4 – Verifica Privilegi e Informazioni Utente

Una volta ottenuto l’accesso, possiamo verificare il contesto e le informazioni utente:

```bash
whoami                   # mostra l'utente attivo
id                       # mostra UID, GID e gruppi
cat /etc/passwd          # elenca gli account del sistema (non contiene password)
sudo -l                  # mostra i comandi eseguibili come root (se sudo è abilitato)
```

Se l’utente appartiene al gruppo `sudo` o ha accesso a comandi privilegiati, è possibile effettuare un’escalation dei privilegi fino a ottenere accesso root.

> **Curiosità:** In alcuni sistemi mal configurati, l’utente SSH ha privilegi root diretti o accesso a comandi critici senza richiesta di password.

---

## 5 – Altre Tecniche e Considerazioni

Oltre al brute force, esistono anche tecniche di raccolta chiavi SSH pubbliche da utenti compromessi, oppure sfruttamento di configurazioni deboli nei file `authorized_keys`, ma queste richiedono accesso iniziale.

Per l’analisi delle chiavi SSH o per accedere via chiave privata, il comando sarà:

```bash
ssh -i key.pem <user>@<IP>     # autenticazione con chiave privata
```

Questa opzione non è brute-forceable direttamente, ma si può tentare il crack delle chiavi offline se rubate.

---
