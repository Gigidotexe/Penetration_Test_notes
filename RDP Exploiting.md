# Exploiting RDP – Remote Desktop Protocol

## Introduzione

**RDP (Remote Desktop Protocol)** è un servizio Microsoft che consente il controllo remoto di un sistema tramite interfaccia grafica.  
È comunemente utilizzato dagli amministratori per gestire sistemi Windows da remoto. Il servizio ascolta solitamente sulla porta **3389**, ma per ragioni di sicurezza può essere spostato su una porta non standard.  
In fase di penetration test, l’identificazione corretta del servizio RDP e l’ottenimento delle credenziali valide possono consentire **accesso completo** al sistema target.

---

## 1 – Rilevamento della porta RDP

Per verificare su quale porta il servizio RDP sia attivo, possiamo utilizzare Metasploit:

`use auxiliary/scanner/rdp/rdp_scanner` ⟶ modulo di scansione per individuare il servizio RDP. <br>
`set RHOSTS <IP>` ⟶ IP della macchina bersaglio. <br>
`set RPORT <porta_sospetta>` ⟶ porta da testare. <br>
`run` ⟶ avvia la scansione per determinare la presenza di RDP. <br>

Questo modulo è utile quando RDP non è presente sulla porta predefinita 3389 ma su una personalizzata.

---

## 2 – Brute Force delle credenziali con Hydra

Dopo aver confermato la presenza del servizio, possiamo tentare un attacco a dizionario per trovare credenziali valide usando **Hydra**:

`hydra -L <pathUsernames> -P <pathPasswords> rdp://<IP> -s <PORT>` ⟶ avvia brute force sul servizio RDP. <br>

- `-L` indica il file con la lista degli username.  
- `-P` indica il file con la lista delle password.  
- `-s` specifica la porta del servizio RDP.  
- `/usr/share/metasploit-framework/data/wordlists/common_users.txt` e `common_passwords.txt` sono ottimi dizionari di partenza.  

Se vogliamo **limitare il numero di richieste simultanee**, possiamo regolare la velocità dei tentativi con:

`-t <numero>` ⟶ numero massimo di thread (es. `-t 4` per renderlo più lento e meno rilevabile). <br>

Quando Hydra trova una coppia valida di credenziali, può restituire un errore nella connessione: ciò accade perché tenta di usare **freerdp**, che in alcuni ambienti (come lab o sistemi legacy) non è supportato.

---

## 3 – Connessione con xfreerdp

Una volta trovate le credenziali valide, possiamo connetterci alla macchina target tramite `xfreerdp`, uno strumento compatibile con vari ambienti grafici:

`xfreerdp /u:<username> /p:<password> /v:<IP>:<PORT>` ⟶ avvia una sessione grafica RDP. <br>

Durante la connessione, potrebbe comparire un messaggio relativo al certificato non verificato: accetta manualmente con `YES`.

---
